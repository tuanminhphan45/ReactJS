'use strict';var _0x24a466=_0x1593;function _0x3474(){var _0xed3a1a=['default','3MuRvbS','remove','14AovuBV','updateOne','deleteAnImage','136805qKwRzy','decorate','filter','pageSize','@nestjs/mongoose','168dGVZJQ','findById','object','model','find','135137RgdWGm','@nestjs/common','slider','length','Book\x20với\x20id\x20=\x20','27208WBNemT','function','defineProperty','Model','2220msiuoF','ceil','updateImageBook','deleteOne','__importDefault','Injectable','assign','\x20không\x20tồn\x20tại\x20trên\x20hệ\x20thống.','api-query-params','populate','getOwnPropertyDescriptor','limit','5510439JyQpru','findOne','skip','name','current','__decorate','BookService','metadata','__esModule','Book','exec','56817NeHGYI','mongoose','BadRequestException','__metadata','37323144zqIats','2910224kChdup','InjectModel','931vGVzCR'];_0x3474=function(){return _0xed3a1a;};return _0x3474();}(function(_0x4c74e0,_0x2bfd5e){var _0xa0927c=_0x1593,_0x111c84=_0x4c74e0();while(!![]){try{var _0x25abc5=-parseInt(_0xa0927c(0x1e9))/0x1*(parseInt(_0xa0927c(0x1dc))/0x2)+parseInt(_0xa0927c(0x212))/0x3*(-parseInt(_0xa0927c(0x20e))/0x4)+parseInt(_0xa0927c(0x1df))/0x5*(parseInt(_0xa0927c(0x1e4))/0x6)+-parseInt(_0xa0927c(0x210))/0x7*(-parseInt(_0xa0927c(0x1ee))/0x8)+parseInt(_0xa0927c(0x209))/0x9*(-parseInt(_0xa0927c(0x1f2))/0xa)+-parseInt(_0xa0927c(0x1fe))/0xb+parseInt(_0xa0927c(0x20d))/0xc;if(_0x25abc5===_0x2bfd5e)break;else _0x111c84['push'](_0x111c84['shift']());}catch(_0x1ded8d){_0x111c84['push'](_0x111c84['shift']());}}}(_0x3474,0xb7c71));var __decorate=this&&this[_0x24a466(0x203)]||function(_0x45526d,_0x22dc27,_0x39e976,_0x39cae9){var _0x4f8c37=_0x24a466,_0x14cf53,_0x1edc31=arguments[_0x4f8c37(0x1ec)],_0x1dd7bc=_0x1edc31<0x3?_0x22dc27:null===_0x39cae9?_0x39cae9=Object[_0x4f8c37(0x1fc)](_0x22dc27,_0x39e976):_0x39cae9;if(_0x4f8c37(0x1e6)==typeof Reflect&&_0x4f8c37(0x1ef)==typeof Reflect[_0x4f8c37(0x1e0)])_0x1dd7bc=Reflect[_0x4f8c37(0x1e0)](_0x45526d,_0x22dc27,_0x39e976,_0x39cae9);else{for(var _0x1531f0=_0x45526d['length']-0x1;0x0<=_0x1531f0;_0x1531f0--)(_0x14cf53=_0x45526d[_0x1531f0])&&(_0x1dd7bc=(_0x1edc31<0x3?_0x14cf53(_0x1dd7bc):0x3<_0x1edc31?_0x14cf53(_0x22dc27,_0x39e976,_0x1dd7bc):_0x14cf53(_0x22dc27,_0x39e976))||_0x1dd7bc);}return 0x3<_0x1edc31&&_0x1dd7bc&&Object[_0x4f8c37(0x1f0)](_0x22dc27,_0x39e976,_0x1dd7bc),_0x1dd7bc;},__metadata=this&&this[_0x24a466(0x20c)]||function(_0x5f2f64,_0x185eac){var _0x55f17c=_0x24a466;if('object'==typeof Reflect&&_0x55f17c(0x1ef)==typeof Reflect[_0x55f17c(0x205)])return Reflect[_0x55f17c(0x205)](_0x5f2f64,_0x185eac);},__param=this&&this['__param']||function(_0x16993e,_0x4f3282){return function(_0x392615,_0x3d4459){_0x4f3282(_0x392615,_0x3d4459,_0x16993e);};},__importDefault=this&&this[_0x24a466(0x1f6)]||function(_0x58683c){var _0x2433b8=_0x24a466;return _0x58683c&&_0x58683c[_0x2433b8(0x206)]?_0x58683c:{'default':_0x58683c};};function _0x1593(_0x31209d,_0x27484d){var _0x3474e3=_0x3474();return _0x1593=function(_0x15936c,_0x57f082){_0x15936c=_0x15936c-0x1dc;var _0xf34d1b=_0x3474e3[_0x15936c];return _0xf34d1b;},_0x1593(_0x31209d,_0x27484d);}Object[_0x24a466(0x1f0)](exports,_0x24a466(0x206),{'value':!0x0}),exports[_0x24a466(0x204)]=void 0x0;const common_1=require(_0x24a466(0x1ea)),book_schema_1=require('./schemas/book.schema'),mongoose_1=require(_0x24a466(0x1e3)),mongoose_2=require(_0x24a466(0x20a)),api_query_params_1=__importDefault(require(_0x24a466(0x1fa)));let BookService=class{constructor(_0x4af229){this['model']=_0x4af229;}async['create'](_0x23d197){var _0xa76ceb=_0x24a466;return this[_0xa76ceb(0x1e7)]['create'](Object[_0xa76ceb(0x1f8)](Object[_0xa76ceb(0x1f8)]({},_0x23d197),{'updatedAt':new Date(),'createdAt':new Date()}));}async['findAll'](_0x56a366,_0x1c405c,_0xb6e668){var _0x50ffdf=_0x24a466,_0x300716,_0x1eef0f,_0x3cea30,_0x3de232,_0x1442a8,_0x7b3c4;return _0x1c405c?({filter:_0x56a366,sort:_0x300716,projection:_0x1eef0f,population:_0x3cea30}=(0x0,api_query_params_1[_0x50ffdf(0x211)])(_0x56a366),_0x56a366['current']&&delete _0x56a366[_0x50ffdf(0x202)],_0x56a366[_0x50ffdf(0x1e2)]&&delete _0x56a366[_0x50ffdf(0x1e2)],_0x3de232=(+_0x1c405c-0x1)*+_0xb6e668,_0x1442a8=+_0xb6e668||0xa,_0x7b3c4=(await this[_0x50ffdf(0x1e7)][_0x50ffdf(0x1e8)](_0x56a366))[_0x50ffdf(0x1ec)],{'meta':{'current':_0x1c405c,'pageSize':_0xb6e668,'pages':Math[_0x50ffdf(0x1f3)](_0x7b3c4/_0x1442a8),'total':_0x7b3c4},'result':await this['model'][_0x50ffdf(0x1e8)](_0x56a366)[_0x50ffdf(0x200)](_0x3de232)[_0x50ffdf(0x1fd)](_0x1442a8)['sort'](_0x300716)[_0x50ffdf(0x1fb)](_0x3cea30)[_0x50ffdf(0x208)]()}):await this['model']['find']({})[_0x50ffdf(0x208)]();}async[_0x24a466(0x1ff)](_0x4d406c){var _0x3e25ff=_0x24a466,_0x4faf2f=await this[_0x3e25ff(0x1e7)][_0x3e25ff(0x1e5)](_0x4d406c);if(_0x4faf2f)return _0x4faf2f;throw new common_1[(_0x3e25ff(0x20b))](_0x3e25ff(0x1ed)+_0x4d406c+'\x20không\x20tồn\x20tại\x20trên\x20hệ\x20thống.');}async['update'](_0x4e6150,_0x5845f8){var _0x668bf4=_0x24a466;if(await this['model']['findById'](_0x4e6150))return this[_0x668bf4(0x1e7)][_0x668bf4(0x1dd)]({'_id':_0x4e6150},Object[_0x668bf4(0x1f8)](Object[_0x668bf4(0x1f8)]({},_0x5845f8),{'updatedAt':new Date()}));throw new common_1[(_0x668bf4(0x20b))](_0x668bf4(0x1ed)+_0x4e6150+_0x668bf4(0x1f9));}async[_0x24a466(0x213)](_0xb8798d){var _0x43deed=_0x24a466;if(await this[_0x43deed(0x1e7)][_0x43deed(0x1e5)](_0xb8798d))return this[_0x43deed(0x1e7)][_0x43deed(0x1f5)]({'_id':_0xb8798d});throw new common_1['BadRequestException'](_0x43deed(0x1ed)+_0xb8798d+_0x43deed(0x1f9));}async[_0x24a466(0x1f4)](_0x65b533,_0x3d002a,_0x32d1bc){var _0xa7020a=_0x24a466,_0x1059cd=await this[_0xa7020a(0x1e7)][_0xa7020a(0x1e5)](_0x65b533);if(_0x1059cd)return _0xa7020a(0x1eb)===_0x3d002a?this[_0xa7020a(0x1e7)]['updateOne']({'_id':_0x65b533},{'slider':[..._0x1059cd['slider'],_0x32d1bc],'updatedAt':new Date()}):this[_0xa7020a(0x1e7)]['updateOne']({'_id':_0x65b533},{'thumbnail':_0x32d1bc,'updatedAt':new Date()});throw new common_1[(_0xa7020a(0x20b))](_0xa7020a(0x1ed)+_0x65b533+'\x20không\x20tồn\x20tại\x20trên\x20hệ\x20thống.');}async[_0x24a466(0x1de)](_0x36a167,_0x1d10f2,_0x500a28){var _0x4ef185=_0x24a466,_0x42016f=await this[_0x4ef185(0x1e7)]['findById'](_0x36a167);if(_0x42016f)return'slider'===_0x500a28?this[_0x4ef185(0x1e7)][_0x4ef185(0x1dd)]({'_id':_0x36a167},{'slider':_0x42016f[_0x4ef185(0x1eb)][_0x4ef185(0x1e1)](_0x2ecc79=>_0x2ecc79!==_0x1d10f2),'updatedAt':new Date()}):this[_0x4ef185(0x1e7)][_0x4ef185(0x1dd)]({'_id':_0x36a167},{'thumbnail':'','updatedAt':new Date()});throw new common_1[(_0x4ef185(0x20b))](_0x4ef185(0x1ed)+_0x36a167+_0x4ef185(0x1f9));}};exports['BookService']=BookService,exports[_0x24a466(0x204)]=BookService=__decorate([(0x0,common_1[_0x24a466(0x1f7)])(),__param(0x0,(0x0,mongoose_1[_0x24a466(0x20f)])(book_schema_1[_0x24a466(0x207)][_0x24a466(0x201)])),__metadata('design:paramtypes',[mongoose_2[_0x24a466(0x1f1)]])],BookService);